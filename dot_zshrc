
# Performance
zmodload zsh/complist
autoload -Uz compinit
if [[ -n "${ZDOTDIR:-$HOME}/.zcompdump" && -N "${ZDOTDIR:-$HOME}/.zcompdump" ]]; then
  compinit -d "${ZDOTDIR:-$HOME}/.zcompdump"
else
  compinit -C -d "${ZDOTDIR:-$HOME}/.zcompdump"
fi

# PATH
typeset -U path PATH
path=(
  $HOME/.local/bin
  $HOME/bin
  $HOME/.codeium/windsurf/bin
  /opt/homebrew/bin
  /opt/homebrew/sbin
  $path
)

export ZSH="$HOME/.oh-my-zsh"

# History
HISTFILE="${ZDOTDIR:-$HOME}/.zsh_history"
HISTSIZE=50000
SAVEHIST=50000
HIST_STAMPS="yyyy-mm-dd"
setopt EXTENDED_HISTORY
setopt SHARE_HISTORY
setopt APPEND_HISTORY
setopt INC_APPEND_HISTORY
setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_FIND_NO_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_SAVE_NO_DUPS
setopt HIST_VERIFY

plugin_list=(
  git
  macos
  brew
  vscode
  nvm
  gh
  gitignore
  npm
  fzf
  zsh-completions
  zsh-history-substring-search
  alias-finder
  autojump
  thefuck
  z
  command-not-found
  zsh-autosuggestions
  zsh-syntax-highlighting
)
plugins=($plugin_list[@])
plugins=("${plugin_list[@]}")
if [[ -s "$ZSH/oh-my-zsh.sh" ]]; then
  source "$ZSH/oh-my-zsh.sh"
fi

[[ -f "$HOME/aliases.zsh" ]] && source "$HOME/aliases.zsh"
[[ -f "$HOME/functions.zsh" ]] && source "$HOME/functions.zsh"

if command -v starship >/dev/null 2>&1; then
  eval "$(starship init zsh)"
fi

export EDITOR="code --wait"
export VISUAL="$EDITOR"

# terminal
setopt AUTO_CD              # cd by typing directory name if it's not a command
setopt CORRECT              # command auto-correction
setopt COMPLETE_ALIASES     # autocompletion of command line switches for aliases
setopt MULTIOS              # perform implicit tees or cats when multiple redirections are attempted

# Environment
export HOMEBREW_NO_ANALYTICS=1
export HOMEBREW_NO_AUTO_UPDATE=1
export LESS="-R"
export PAGER="less"

[ -f ~/.zshrc.bw ] && source ~/.zshrc.bw

if command -v gh >/dev/null 2>&1 && gh extension list | grep -q 'copilot'; then
  eval "$(gh copilot alias -- zsh)"
fi
